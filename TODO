Add a signal handler so that the pidfile is removed when receiving SIGTERM
or SIGKILL or SIGINT (and also exit the main loop)
Add a timer so that the daemon exits after a while
Remove deprecated functions to use newer (and simpler) ones
